/*! siebelloginfoextract 2017-01-31 */
requirejs(["jquery","underscore","clipboard","papaparse"],function(a,b,c,d){window.matchMedia=window.matchMedia||function(){return{matches:!1,addListener:function(){},removeListener:function(){}}},a(document).ready(function(){function e(a,b){if("file"==a.type){var c=a.value;if(c.length>0){for(var d=!1,e=0;e<b.length;e++){var f=b[e];if(c.substr(c.length-f.length,f.length).toLowerCase()==f.toLowerCase()){d=!0;break}}if(!d)return alert("Sorry, file extension must be: "+b.join(", ")),a.value="",!1}}return!0}function f(a){switch(a.target.error.code){case a.target.error.NOT_FOUND_ERR:alert("File Not Found!");break;case a.target.error.NOT_READABLE_ERR:alert("File is not readable");break;case a.target.error.ABORT_ERR:break;default:alert("An error occurred reading this file.")}}function g(a,b){var c=document.getElementById(b).getElementsByClassName("percent")[0];if(a.lengthComputable){var d=Math.round(a.loaded/a.total*100);d<100&&(c.style.width=d+"%",c.textContent=d+"%")}}function h(b){var c=b.data.type,d=b.data.elementId,h=b.data.fileContentId,i=document.getElementById(d).getElementsByClassName("percent")[0];if("log"==b.data.type){if(0==e(this,[".log"]))return}else if(0==e(this,[".csv"]))return;i.style.width="0%",i.textContent="0%",k=new FileReader,k.onerror=f,k.onprogress=g.call(this,b,d),k.onabort=function(a){alert("File read cancelled")},k.onloadstart=function(a){document.getElementById(d).className="loading"},k.onload=function(b){if(i.style.width="100%",i.textContent="100%",setTimeout("document.getElementById('"+d+"').className='';",2e3),"log"==c){for(var e=this.result.split("\n"),f=0;f<e.length;f++)l.push(e[f]);a("#"+h).html(l[0]+" ...")}else m=b.target.result,a("#"+h).html(m.substring(1,100)+" ...")},k.readAsText(b.target.files[0])}function i(c){var d=c.data.c,e=c.data.s,f=c.data.f,g="",h=[],i="results_output";if("ONLY_SBL_ERRS"==f){for(var j in d)for(var k in e)if(d[j].indexOf(e[k])>-1){var l=d[j].indexOf(e[k]);h.push(d[j].substring(l,l+13))}h=b.uniq(h).sort()}else if("ONLY_SBL_ERRS_WITH_DESC"==f){for(var j in d)for(var k in e)if(d[j].indexOf(e[k])>-1){var l=d[j].indexOf(e[k]);h.push(d[j].substring(l,d[j].length))}h=b.uniq(h).sort()}else if("ONLY_BAD_SQL"==f){i="results_output_performance";for(var j in d)for(var k in e)d[j].indexOf(e[k])>-1&&a.each(d[j].split(" "),function(a,b){b.indexOf(".")>-1&&parseInt(b.split(".")[0])>0&&h.push(d[j])})}else if("ONLY_BAD_BS"==f){i="results_output_performance";for(var j in d)for(var k in e)d[j].indexOf(e[k])>-1&&a.each(d[j].split(" "),function(a,b){b.indexOf(".")>-1&&parseInt(b.split(".")[0])>0&&h.push(d[j])})}else for(var j in d)for(var k in e)d[j].indexOf(e[k])>-1&&h.push(d[j]);d.length>0?h.length>0?(a.each(h,function(a,b){g+=h[a]+"&#13;&#10;"}),a("#"+i).html(g)):alert("No lines found !"):alert("No file loaded !")}function j(c){var e="",f=d.parse(m,{header:!0});f=f.data,f=b.sortBy(f,"FdrID");f.slice(Math.max(f.length-20,1));for(var g in f)e+=f[g].FdrID+" ",e+=f[g].ThreadID+" ",e+=f[g].AreaDesc+" ",e+=f[g].AreaSymbol+" ",e+=f[g].SubAreaDesc+" ",e+=f[g].SubAreaSymbol+" ",e+=f[g].UTC+" ",e+=f[g].UserInt1+" ",e+=f[g].UserInt2+" ",e+=f[g].UserStr1+" ",e+=f[g].UserStr2+"&#13;&#10;";a("#results_output_fdr").html(e)}"undefined"!=typeof window.componentHandler&&window.componentHandler.upgradeAllRegistered(),window.File&&window.FileReader&&window.FileList&&window.Blob||alert("The File APIs are not fully supported in this browser.");var k,l=[],m="";new c("#copy-button"),new c("#copy-button-performance"),new c("#copy-button-fdr"),a("#files").change({elementId:"progress_bar",fileContentId:"file_content",type:"log"},h),a("#files-performance").change({elementId:"progress_bar_performance",fileContentId:"file_content_performance",type:"log"},h),a("#files-fdr").change({elementId:"progress_bar_fdr",fileContentId:"file_content_fdr",type:"csv"},h),a("#check_js").on("click",{c:l,s:["***MANIFEST_LOG*** Adding File: siebel/custom"],f:""},i),a("#check_ev").on("click",{c:l,s:["EventContext"],f:""},i),a("#check_sbl").on("click",{c:l,s:["SBL-"],f:"ONLY_SBL_ERRS"},i),a("#check_sbl_desc").on("click",{c:l,s:["SBL-"],f:"ONLY_SBL_ERRS_WITH_DESC"},i),a("#check_ev_sbl").on("click",{c:l,s:["EventContext","SBL-"],f:""},i),a("#check_errors").on("click",{c:l,s:["error"],f:""},i),a("#lines_with_bad_sql").on("click",{c:l,s:["seconds *****"],f:"ONLY_BAD_SQL"},i),a("#lines_with_bad_bs").on("click",{c:l,s:["Execute Time:"],f:"ONLY_BAD_BS"},i),a("#lines_before_crash").on("click",{c:m},j)})});